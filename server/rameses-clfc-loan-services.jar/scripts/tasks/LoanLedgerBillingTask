import com.rameses.common.*;
import com.rameses.annotations.*;

class LoanLedgerBillingTask
{
	@ActiveDB(value="loan_ledger_billing")
	def ledger_billing;

	@Service("DateService")
	def dateSvc;

	@Schedule(interval=1, timeUnit="DAYS", immediate=true)
	public void cancelPastDraftBillings( task ) {
		def date = dateSvc.serverDate.toString().split(' ')[0];
		def list = ledger_billing.getPastDraftBillings([date: date]);
		list.each{
			it.state = 'CANCELLED';
			ledger_billing.update(it);
		}
	}
}