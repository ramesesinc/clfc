import com.rameses.annotations.*;
import com.rameses.common.*;
import java.rmi.server.UID;

class LoanAppInterceptor
{
	@ActiveDB(value='loanapp')
	def em;

	@After(pattern='PrincipalBorrowerService.update') 
	public void afterUpdatePrincipalBorrower( evt ) { 
		def result = evt.result; 

	} 

	private String createFullName(lname, fname, mname) {
		def s = lname + ', ' + fname; 
		if (mname) s = s + ' ' + mname; 

		return s;
	}

	private void updatePrincipalBorrower(data) {
		def o = em.findBorrower([parentid: data._loanappid, type: 'PRINCIPAL']);
		if (o == null) {
			o = [ 
				objid: 'LBRWR' + new UID(), 
				parentid: data._loanappid, 
				borrowerid: data.objid, 
				principalid: data.objid,  
				type: 'PRINCIPAL' 
			]; 
			em.create(o, 'borrower'); 
		} else {
			o.borrowerid = data.objid;
			o.principalid = data.objid; 
			em.update(o, 'borrower'); 
		} 
	}
}  
